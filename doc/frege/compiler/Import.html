<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<META http-equiv="Content-Type" content="text/html;charset=utf-8">
<TITLE>frege.compiler.Import - frege documentation</TITLE>
<style TYPE="text/css">
body { font-family: helvetica, arial, sans-serif }
pre { font-family: "lucida console", "courier new", monospaced; font-size: 100%; color: rgb(0%,0%,60%) }
h3  { font-weight: lighter }
dt.func { background: rgb(95%, 95%, 80%) }
dt.clas { background: rgb(80%, 95%, 95%) }
dt.inst { background: rgb(95%, 90%, 95%) }
dt.data { background: rgb(95%, 95%, 95%) }
span.code { font-family: "lucida console", "courier new", monospaced; font-size: 100%; color: rgb(0%,0%,60%) }
span.unknown { font-family: "lucida console", "courier new", monospaced; font-size: 100%; color: red }
a.fref { text-decoration: none; font-family: "lucida console", "courier new", monospaced; font-size: 100%; color: rgb(30%, 30%, 0%) }
a.tref { text-decoration: none; font-family: "lucida console", "courier new", monospaced; font-size: 100%; color: rgb(40%, 0%,  40%) }
</style>
<BODY>
<H1>
<A name="package">Package <SPAN CLASS="code">frege.compiler.Import</SPAN></A></H1>
<P>
Compiled: Thu Oct 20 00:58:44 CEST 2011 from source file: <SPAN CLASS="code">.\frege\compiler\Import.fr</SPAN></P>
<H3>
Package Documentation</H3>
<P>
This package implements the second compiler pass after lexical analysis. It sets up the symbol table and performs the imports.</P>
<H3>
Table of Content</H3>
<UL>
<LI>
<DIV>
<A HREF="#let">Functions and Values (alphabetically)</A></DIV>
<DIV>
<A class="fref" href="#doImports">doImports</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#importClass">importClass</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#importClassData">importClassData</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#importEnv">importEnv</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#importHere">importHere</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#linkHere">linkHere</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#linkItem">linkItem</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#mapqs">mapqs</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#pass">pass</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#post">post</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#preludeBasics">preludeBasics</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#rebuildQN">rebuildQN</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#version">version</A></DIV>
</LI>
<LI>
<DIV>
<A HREF="#case">Functions and Values (by type)</A></DIV>
<DIV>
<A class="fref" href="#doImports">doImports</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#importClass">importClass</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#importClassData">importClassData</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#importEnv">importEnv</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#importHere">importHere</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#linkHere">linkHere</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#linkItem">linkItem</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#mapqs">mapqs</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#pass">pass</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#post">post</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#preludeBasics">preludeBasics</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#rebuildQN">rebuildQN</A>&nbsp;&nbsp;&nbsp; <A class="fref" href="#version">version</A></DIV>
</LI>
</UL>
<H3>
Imports</H3>
<UL>
<LI>
<DIV>
import <A HREF="../Prelude.html">frege.Prelude</A> as Prelude</DIV>
</LI>
<LI>
<DIV>
import <A HREF="./Classtools.html">frege.compiler.Classtools</A> as CT</DIV>
</LI>
<LI>
<DIV>
import <A HREF="./Data.html">frege.compiler.Data</A> as D</DIV>
</LI>
<LI>
<DIV>
import <A HREF="../List.html">frege.List</A> as List</DIV>
</LI>
<LI>
<DIV>
import <A HREF="../prelude/Text.html">frege.prelude.Text</A> as PreludeText</DIV>
</LI>
<LI>
<DIV>
import <A HREF="../prelude/Base.html">frege.prelude.Base</A> as PreludeBase</DIV>
</LI>
<LI>
<DIV>
import <A HREF="../Tuples.html">frege.Tuples</A> as Tuples</DIV>
</LI>
<LI>
<DIV>
import <A HREF="./Utilities.html">frege.compiler.Utilities</A> as U</DIV>
</LI>
</UL>
<H2>
<A name="let">Functions and Values</A></H2>
<DL class="func">
<DT class="func">
<SPAN CLASS="code"><A name="doImports">doImports</A> :: <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
check definitions for Prelude import. if not there, prepend an automatic <SPAN CLASS="code">import frege.Prelude</SPAN></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="importClass">importClass</A> :: <A class="tref" href="../prelude/Base.html#Int">Int</A> -&gt; <A class="tref" href="./Data.html#Pack">D.Pack</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="importClassData">importClassData</A> :: <A class="tref" href="../prelude/Base.html#Int">Int</A> -&gt; <A class="tref" href="./Data.html#Pack">D.Pack</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> (<A class="tref" href="../prelude/Base.html#Maybe">Maybe</A> <A class="tref" href="./Classtools.html#FregePackage">CT.FregePackage</A>)</SPAN></DT>
<DD class="func">
<P>
Reconstruct symbol table of imported package from annotation class <A class="tref" href="./Classtools.html#FregePackage">CT.FregePackage</A></P>
<P>
Only the most obvious logical errors are recognized, however, they will cause the compiler to crash.</P>
<P>
We rely on the following:</P>
<UL>
<LI>
 java annotations contain no null values </LI>
<LI>
 all indexes into the <A class="tref" href="./Classtools.html#Tau">CT.Tau</A>, <A class="tref" href="./Classtools.html#Rho">CT.Rho</A> and <A class="tref" href="./Classtools.html#Sigma">CT.Sigma</A> arrays are valid. </LI>
</UL>
<P>
Should the assumptions fail to hold then the import will crash with an ArrayOutOfBounds or a NullPointer exception.</P>
<P>
On the other hand, if the code in "GenMeta.fr" is correct and the annotations have not been hacked (for example by editing intermediate java files), then the import is guaranteed not to crash.</P>
<P>
This uses and updates the cache of frege packages from class files which are up to date whether or not the <A class="fref" href="./Data.html#Flag:MAKE">D.Flag.MAKE</A> option is set. This avoids construction of a class loader also in cases when multiple source files are compiled.</P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="importEnv">importEnv</A> :: <A class="tref" href="../prelude/Base.html#Int">Int</A> -&gt; <A class="tref" href="../List.html#Tree">List.Tree</A> <A class="tref" href="../prelude/Base.html#String">String</A> <A class="tref" href="./Data.html#Symbol">D.Symbol</A> -&gt; <A class="tref" href="./Data.html#NSName">D.NSName</A> -&gt; <A class="tref" href="./Data.html#ImportList">D.ImportList</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
Process an import list</P>
<P>
An export list with except list is equivalent to one that names all public top level symbols whose name does not appear in the list.</P>
<P>
A public import list is equivalent to one without public but public specified for all items.</P>
<P>
All items in the list are processed one by one</P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="importHere">importHere</A> :: <B><A class="tref" href="./Data.html#DefinitionT">D.DefinitionT</A></B> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="linkHere">linkHere</A> :: <A class="tref" href="../prelude/Base.html#String">String</A> -&gt; <A class="tref" href="./Data.html#ImportItem">D.ImportItem</A> -&gt; <A class="tref" href="./Data.html#Symbol">D.Symbol</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
a symbolic link is dereferenced and the link goes to the target</P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="linkItem">linkItem</A> :: <B><A class="tref" href="../prelude/Base.html#String">String</A></B> -&gt; <A class="tref" href="./Data.html#ImportItem">D.ImportItem</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="mapqs">mapqs</A> :: <B><A class="tref" href="./Classtools.html#QNameArr">CT.QNameArr</A></B> -&gt; [<A class="tref" href="./Data.html#QName">D.QName</A>]</SPAN></DT>
<DD class="func">
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="pass">pass</A> :: <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> (<A class="tref" href="../prelude/Base.html#String">String</A>, <A class="tref" href="../prelude/Base.html#Int">Int</A>)</SPAN></DT>
<DD class="func">
<P>
import pass, set up environment and do imports</P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="post">post</A> :: <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Bool">Bool</A></SPAN></DT>
<DD class="func">
<P>
Post condition for import pass</P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="preludeBasics">preludeBasics</A> :: <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
These are the basic definitions that we can't write in sourcecode: data () = (); data [] a = [] | a `:` [a]; data (,) a b = (a,b)     # tuples 2 to 26 data (-&gt;) a b; data while a b = continue a | break b preludedefs is a symbol table containing those It must be used as base for prelude compilation</P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="rebuildQN">rebuildQN</A> :: <B><A class="tref" href="./Classtools.html#QName">CT.QName</A></B> -&gt; <A class="tref" href="./Data.html#QName">D.QName</A></SPAN></DT>
<DD class="func">
</DD>
<DT class="func">
<SPAN CLASS="code"><A name="version">version</A> :: <A class="tref" href="../prelude/Base.html#Int">Int</A></SPAN></DT>
<DD class="func">
<P>
This is $Revision: 228 $</P>
</DD>
</DL>
<H2>
<A name="case">Functions and Values by Type</A></H2>
<DL class="func">
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="./Classtools.html#QName">CT.QName</A> -&gt; <A class="tref" href="./Data.html#QName">D.QName</A></SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#rebuildQN">rebuildQN</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="./Classtools.html#QNameArr">CT.QNameArr</A> -&gt; [<A class="tref" href="./Data.html#QName">D.QName</A>]</SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#mapqs">mapqs</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="./Data.html#DefinitionT">D.DefinitionT</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#importHere">importHere</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="../prelude/Base.html#Int">Int</A> -&gt; <A class="tref" href="../List.html#Tree">List.Tree</A> <A class="tref" href="../prelude/Base.html#String">String</A> <A class="tref" href="./Data.html#Symbol">D.Symbol</A> -&gt; <A class="tref" href="./Data.html#NSName">D.NSName</A> -&gt; <A class="tref" href="./Data.html#ImportList">D.ImportList</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#importEnv">importEnv</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="../prelude/Base.html#Int">Int</A> -&gt; <A class="tref" href="./Data.html#Pack">D.Pack</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> (<A class="tref" href="../prelude/Base.html#Maybe">Maybe</A> <A class="tref" href="./Classtools.html#FregePackage">CT.FregePackage</A>)</SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#importClassData">importClassData</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="../prelude/Base.html#Int">Int</A> -&gt; <A class="tref" href="./Data.html#Pack">D.Pack</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#importClass">importClass</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="../prelude/Base.html#String">String</A> -&gt; <A class="tref" href="./Data.html#ImportItem">D.ImportItem</A> -&gt; <A class="tref" href="./Data.html#Symbol">D.Symbol</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#linkHere">linkHere</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="../prelude/Base.html#String">String</A> -&gt; <A class="tref" href="./Data.html#ImportItem">D.ImportItem</A> -&gt; <A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#linkItem">linkItem</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> (<A class="tref" href="../prelude/Base.html#String">String</A>, <A class="tref" href="../prelude/Base.html#Int">Int</A>)</SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#pass">pass</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Unit">()</A></SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#doImports">doImports</A>, <A class="fref" href="#preludeBasics">preludeBasics</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="./Data.html#StIO">D.StIO</A> <A class="tref" href="./Data.html#Global">D.Global</A> <A class="tref" href="../prelude/Base.html#Bool">Bool</A></SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#post">post</A></P>
</DD>
<DT class="func">
<SPAN CLASS="code"><A class="tref" href="../prelude/Base.html#Int">Int</A></SPAN></DT>
<DD class="func">
<P>
<A class="fref" href="#version">version</A></P>
</DD>
</DL>
<P>
<A HREF="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-html401" alt="Valid HTML 4.01 Strict" height="31" width="88"></A></P>
</BODY>
</HTML>
